import { Goal, Mood, UserProfile } from "@/models/User";

const FALLBACK: string[] = [
  "–ü—Ä–∏–≤–µ—Ç! –ß—Ç–æ —Ö–æ—Ä–æ—à–µ–≥–æ —É —Ç–µ–±—è —Å–µ–≥–æ–¥–Ω—è?",
  "–ü—Ä–∏–≤–µ—Ç üòä –ö–∞–∫ –ø—Ä–æ—Ö–æ–¥–∏—Ç —Ç–≤–æ–π –¥–µ–Ω—å?",
  "–•–µ–π! –ß—Ç–æ –±—ã —Ç—ã –¥–µ–ª–∞–ª(–∞), –µ—Å–ª–∏ –±—ã —Å–µ–π—á–∞—Å –±—ã–ª–æ –∏–¥–µ–∞–ª—å–Ω–æ–µ —É—Ç—Ä–æ?",
];

const GOAL_BASED: Partial<Record<Goal, string[]>> = {
  dating: [
    "–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫–æ–π —Ñ–æ—Ä–º–∞—Ç —Å–≤–∏–¥–∞–Ω–∏—è —Ç–µ–±–µ –±–æ–ª—å—à–µ –∑–∞—Ö–æ–¥–∏—Ç: –∫–æ—Ñ–µ, –ø—Ä–æ–≥—É–ª–∫–∞ –∏–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ–æ–±—ã—á–Ω–æ–µ?",
    "–ï—Å–ª–∏ –±—ã —É –Ω–∞—Å –±—ã–ª–æ –ø–µ—Ä–≤–æ–µ —Å–≤–∏–¥–∞–Ω–∏–µ, –∫—É–¥–∞ –±—ã —Ç—ã –ø—Ä–µ–¥–ª–æ–∂–∏–ª(–∞) –ø–æ–π—Ç–∏?",
  ],
  friends: [
    "–ü—Ä–∏–≤–µ—Ç! –ò—â–µ—à—å –∫–æ–º–ø–∞–Ω–∏—é –¥–ª—è —á–µ–≥–æ –±–æ–ª—å—à–µ ‚Äì –∫–æ—Ñ–µ, –ø—Ä–æ–≥—É–ª–æ–∫ –∏–ª–∏ –Ω–∞—Å—Ç–æ–ª–æ–∫?",
    "–ï—Å–ª–∏ –±—ã –º—ã –ø—Ä–æ—Å—Ç–æ —Ç—É—Å–∏–ª–∏ –∫–∞–∫ –¥—Ä—É–∑—å—è, —á—Ç–æ –±—ã —Ç—ã –ø—Ä–µ–¥–ª–æ–∂–∏–ª(–∞) —Å–¥–µ–ª–∞—Ç—å?",
  ],
  chat: [
    "–ü—Ä–∏–≤–µ—Ç! –û —á—ë–º —Ç–µ–±–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–µ–µ –≤—Å–µ–≥–æ –±–æ–ª—Ç–∞—Ç—å —Å –ª—é–¥—å–º–∏?",
    "–ï—Å–ª–∏ –±—ã –º—ã –∑–∞–≤–∏—Å–ª–∏ –≤ —á–∞—Ç–µ –Ω–∞ —á–∞—Å, –æ —á—ë–º –±—ã —Ç–æ—á–Ω–æ –ø–æ–≥–æ–≤–æ—Ä–∏–ª–∏?",
  ],
  long_term: [
    "–ü—Ä–∏–≤–µ—Ç! –ß—Ç–æ –¥–ª—è —Ç–µ–±—è —Å–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ –≤ –ª—é–¥—è—Ö —Ä—è–¥–æ–º?",
    "–ö–∞–∫ —Ç—ã –ø–æ–Ω–∏–º–∞–µ—à—å, —á—Ç–æ —á–µ–ª–æ–≤–µ–∫ ¬´—Å–≤–æ–π¬ª?",
  ],
  short_term: [
    "–ü—Ä–∏–≤–µ—Ç! –ß—Ç–æ –¥–ª—è —Ç–µ–±—è –∏–¥–µ–∞–ª—å–Ω—ã–π –ª—ë–≥–∫–∏–π –≤–µ—á–µ—Ä?",
    "–ó–∞ —Å—á—ë—Ç —á–µ–≥–æ —á–µ–ª–æ–≤–µ–∫ –º–æ–∂–µ—Ç —Ç–µ–±—è —Ä–∞—Å–ø–æ–ª–æ–∂–∏—Ç—å –∫ —Å–µ–±–µ —Å –ø–µ—Ä–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π?",
  ],
};

const MOOD_BASED: Partial<Record<Mood, string[]>> = {
  happy: [
    "–í–∏–∂—É —Ö–æ—Ä–æ—à–µ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ üôÇ –ß—Ç–æ –µ–≥–æ —Å–µ–≥–æ–¥–Ω—è –ø–æ–¥–Ω—è–ª–æ?",
    "–ö–∞–∂–µ—Ç—Å—è, —Ç—ã –Ω–∞ –ø–æ–∑–∏—Ç–∏–≤–µ. –ß—Ç–æ —Å–µ–≥–æ–¥–Ω—è –ø–æ—Ä–∞–¥–æ–≤–∞–ª–æ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ?",
  ],
  chill: [
    "–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ —á–∏–ª. –ö–∞–∫ –ª—É—á—à–µ –≤—Å–µ–≥–æ —Ä–∞—Å—Å–ª–∞–±–ª—è–µ—à—å—Å—è –ø–æ—Å–ª–µ –¥–Ω—è?",
    "–ï—Å–ª–∏ –±—ã –º—ã –ø—Ä–æ—Å—Ç–æ —á–∏–ª–∏–ª–∏, —á—Ç–æ –±—ã –¥–µ–ª–∞–ª–∏ ‚Äì –∫–∏–Ω–æ, –º—É–∑—ã–∫–∞ –∏–ª–∏ –ø—Ä–æ–≥—É–ª–∫–∞?",
  ],
  active: [
    "–¢—ã –∫–∞–∂–µ—à—å—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º —á–µ–ª–æ–≤–µ–∫–æ–º. –ö–∞–∫–æ–π –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–ø–æ–Ω—Ç–∞–Ω–Ω—ã–π –ø–æ—Å—Ç—É–ø–æ–∫ —É —Ç–µ–±—è –±—ã–ª?",
    "–ß—Ç–æ –¥–ª—è —Ç–µ–±—è –ª—É—á—à–∏–π –∞–∫—Ç–∏–≤–Ω—ã–π –≤—ã—Ö–æ–¥–Ω–æ–π?",
  ],
  serious: [
    "–ö–∞–∂–µ—à—å—Å—è –¥–æ–≤–æ–ª—å–Ω–æ –æ—Å–æ–∑–Ω–∞–Ω–Ω—ã–º —á–µ–ª–æ–≤–µ–∫–æ–º. –ß—Ç–æ –¥–ª—è —Ç–µ–±—è —Å–µ–π—á–∞—Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –≤ –∂–∏–∑–Ω–∏?",
    "–í–æ —á—Ç–æ —Ç—ã –∏–Ω–≤–µ—Å—Ç–∏—Ä—É–µ—à—å —Å–≤–æ—ë –≤—Ä–µ–º—è –∏ —ç–Ω–µ—Ä–≥–∏—é –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å?",
  ],
  party: [
    "–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ ¬´party¬ª ü•≥ –ì–¥–µ —Ç–µ–±–µ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –Ω—Ä–∞–≤–∏–ª–æ—Å—å —Ç—É—Å–∏—Ç—å?",
    "–ü—Ä–µ–¥—Å—Ç–∞–≤—å –∏–¥–µ–∞–ª—å–Ω—É—é –≤–µ—á–µ—Ä–∏–Ω–∫—É. –ß—Ç–æ —Ç–∞–º —Ç–æ—á–Ω–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å?",
  ],
};

export function getIcebreakerForUser(
  user: Pick<UserProfile, "goal" | "mood" | "interests" | "displayName">
): string {
  const pool: string[] = [];

  if (user.goal && GOAL_BASED[user.goal]) {
    pool.push(...(GOAL_BASED[user.goal] ?? []));
  }

  if (user.mood && MOOD_BASED[user.mood]) {
    pool.push(...(MOOD_BASED[user.mood] ?? []));
  }

  if (user.interests && user.interests.length > 0) {
    const topInterest = user.interests[0];
    if (topInterest) {
      pool.push(
        `–í–∏–∂—É –∏–Ω—Ç–µ—Ä–µ—Å –∫ ¬´${topInterest}¬ª. –ö–∞–∫ —Ç—ã –∫ —ç—Ç–æ–º—É –ø—Ä–∏—à—ë–ª(–ø—Ä–∏—à–ª–∞)?`,
        `–†–∞—Å—Å–∫–∞–∂–∏ —á—Ç–æ-–Ω–∏–±—É–¥—å –∑–∞–±–∞–≤–Ω–æ–µ, —Å–≤—è–∑–∞–Ω–Ω–æ–µ —Å ¬´${topInterest}¬ª.`
      );
    }
  }

  if (pool.length === 0) {
    return FALLBACK[Math.floor(Math.random() * FALLBACK.length)];
  }

  return pool[Math.floor(Math.random() * pool.length)];
}
